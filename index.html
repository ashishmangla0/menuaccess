<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .dropdown-menu {
        display: none;
      }
      .dropdown-menu.show {
        display: block;
      }
    </style>
  </head>
  <body>
    <div class="dropdown">
      <button
        class="btn btn-secondary dropdown-toggle"
        type="button"
        id="dropdownMenuButton1"
        aria-expanded="false"
        aria-haspopup="true"
      >
        Dropdown button
      </button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
        <a class="dropdown-item" href="#">Action</a>
        <a class="dropdown-item" href="#">Another action</a>
        <a class="dropdown-item" href="#">Something else here</a>
      </div>
    </div>
    <div class="dropdown">
      <button
        class="btn btn-secondary dropdown-toggle"
        type="button"
        id="dropdownMenuButton2"
        aria-expanded="false"
        aria-haspopup="true"
      >
        Dropdown button 2
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
        <li><a class="dropdown-item" href="#">Action</a></li>
        <li><a class="dropdown-item" href="#">Another action</a></li>
        <li><a class="dropdown-item" href="#">Something else here</a></li>
      </ul>
    </div>

    <script>
      const allDropdown = document.querySelectorAll(".dropdown-toggle");

      // const handleKeydown = (event) => {
      //   var tgt = event.currentTarget;
      //   console.log(tgt);
      //   console.log(event.keyCode);
      //   switch (event.keyCode) {
      //     case keyCode.ESC:
      //       console.log("I am escape");
      //       break;
      //   }
      // };
      // allDropdown.forEach((dropdown) => {
      //   this.keyCode = Object.freeze({
      //     TAB: 9,
      //     RETURN: 13,
      //     ESC: 27,
      //     SPACE: 32,
      //     PAGEUP: 33,
      //     PAGEDOWN: 34,
      //     END: 35,
      //     HOME: 36,
      //     LEFT: 37,
      //     UP: 38,
      //     RIGHT: 39,
      //     DOWN: 40,
      //   });

      //   dropdown.addEventListener("keydown", handleKeydown);
      // });

      allDropdown.forEach((dropdown) => {
        const keyCode = {
          TAB: 9,
          RETURN: 13,
          ESC: 27,
          SPACE: 32,
          PAGEUP: 33,
          PAGEDOWN: 34,
          END: 35,
          HOME: 36,
          LEFT: 37,
          UP: 38,
          RIGHT: 39,
          DOWN: 40,
        };
        dropdown.addEventListener("keydown", function (e) {
          var tgt = e.currentTarget;
          char = e.key;
          console.log(char);
          switch (e.keyCode) {
            case keyCode.ESC:
              dropdown.setAttribute("aria-expanded", false);
              dropdown.nextElementSibling.classList.remove("show");
              break;
          }
        });

        dropdown.addEventListener("focus", function (e) {
          var tgt = e.currentTarget;
          const getAriaExpand = tgt.getAttribute("aria-expanded") === false;
          dropdown.setAttribute("aria-expanded", !getAriaExpand);
          console.log(getAriaExpand);
          let menu = dropdown.nextElementSibling;
          menu.classList.toggle("show");
          //menu.firstChild.focus();
        });
        dropdown.addEventListener("click", function (e) {
          var tgt = e.currentTarget;
          const getAriaExpand = tgt.getAttribute("aria-expanded") === false;
          dropdown.setAttribute("aria-expanded", !getAriaExpand);
          console.log(getAriaExpand);
          let menu = dropdown.nextElementSibling;
          menu.classList.toggle("show");
          console.log(menu);
          let aa = menu.firstElementChild;
          aa.focus();
          console.log(aa);
          
          //console.log(aa.focus());
          //menu.firstChild.focus();
        });
      });
    </script>
  </body>
</html>
